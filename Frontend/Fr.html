<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Event Horizon â€” Animated Event Page</title>

<!-- Bootstrap Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

<style>
  :root{
    --bg:#eef4ff;
    --card:#ffffff;
    --muted:#6b7280;
    --primary:#2f6bff;
    --accent:#dfeaff;
    --dark:#0f1724;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background:var(--bg);
    color:var(--dark);
    -webkit-font-smoothing:antialiased;
    scroll-behavior:smooth;
  }

  /* === TOP SCROLL PROGRESS BAR === */
  .scroll-progress {
    position:fixed; left:0; right:0; top:0;
    height:4px;
    background:linear-gradient(90deg,var(--primary), #6ea1ff);
    transform-origin: left center;
    transform: scaleX(0);
    z-index:9999;
    transition: transform 120ms linear;
    pointer-events:none;
  }

  /* Header */
  .header{
    display:flex; align-items:center; gap:12px;
    padding:14px 28px; background:var(--bg);
    border-bottom:1px solid rgba(15,23,36,0.04);
    position:sticky; top:0; z-index:900;
    transform: translateY(-14px); opacity:0;
    transition: transform 540ms cubic-bezier(.2,.9,.3,1), opacity 420ms ease;
    backdrop-filter: blur(6px);
  }
  .header.visible{ transform: translateY(0); opacity:1; }

  .brand{ display:flex; align-items:center; gap:10px; font-weight:700; font-size:20px; }
  .brand i{ font-size:22px; color:var(--primary); transition: transform 220ms ease; }
  .brand:hover i{ transform: rotate(-6deg) scale(1.05); }

  /* Hero */
  .hero{
    height:70vh; min-height:360px;
    background-image: url('https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=400');
    background-size: cover; background-position: center;
    display:flex; align-items:center; justify-content:center;
    text-align:center; position:relative; color:white; overflow:hidden; perspective:1000px;
  }
  .hero-bg {
    position:absolute; inset:0;
    background-image: inherit;
    background-size: cover; background-position: center;
    transform: translateZ(0);
    will-change: transform;
    transition: transform 300ms ease-out;
    filter: saturate(0.95) contrast(0.95);
  }
  .hero::after{ content:""; position:absolute; inset:0; background:linear-gradient(180deg, rgba(2,6,23,0.25), rgba(2,6,23,0.45)); z-index:1; }
  .hero-inner{ position:relative; z-index:2; padding:0 24px; max-width:1100px; }

  .hero h1{
    font-size:48px; font-weight:800; margin:0 0 10px;
    transform-origin:center; opacity:0; transform: translateY(8px) rotateX(8deg);
    transition: transform 700ms cubic-bezier(.2,.9,.3,1), opacity 700ms ease;
    will-change: transform, opacity; text-shadow: 0 6px 30px rgba(0,0,0,0.35);
  }
  .hero p{
    font-size:20px; margin:0; font-weight:300; color: rgba(255,255,255,0.94);
    opacity:0; transform: translateY(6px);
    transition: transform 700ms 120ms cubic-bezier(.2,.9,.3,1), opacity 700ms 120ms ease;
  }
  @keyframes floaty { 0%{ transform: translateY(0) } 50%{ transform: translateY(-8px) } 100%{ transform: translateY(0) } }
  .hero.show h1{ opacity:1; transform: translateY(0) rotateX(0); animation: floaty 6s ease-in-out infinite; }
  .hero.show p{ opacity:1; transform: translateY(0); animation: floaty 5.6s ease-in-out infinite; }

  /* Layout */
  .container{ max-width:1150px; margin:36px auto 90px; padding:0 20px; display:grid; grid-template-columns:1fr 340px; gap:40px; align-items:start; }

  /* About */
  .about{ opacity:0; transform: translateY(8px); transition: transform 520ms ease, opacity 520ms ease; }
  .about.visible{ opacity:1; transform: translateY(0); }
  .about h2{ font-size:32px; font-weight:800; margin-bottom:10px; }
  .about p{ font-size:18px; line-height:1.75; color:var(--muted); }

  /* Schedule title */
  .schedule-title{ font-size:32px; font-weight:800; margin:30px 0 18px; opacity:0; transform: translateY(8px); transition: transform 520ms 120ms ease, opacity 520ms 120ms ease; }
  .schedule-title.visible{ opacity:1; transform: translateY(0); }

  /* Timeline */
  .timeline{ position:relative; padding-left:30px; }
  .timeline::before{ content:""; position:absolute; left:20px; top:12px; bottom:0; width:2px; background:linear-gradient(180deg, rgba(47,107,255,0.25), rgba(47,107,255,0.05)); }

  .event{
    position:relative; padding:22px 20px 22px 36px;
    opacity:0; transform: translateX(-18px) rotateX(6deg); transform-origin:left center;
    transition: transform 560ms cubic-bezier(.2,.9,.3,1), opacity 520ms ease;
  }
  .event.visible{ opacity:1; transform: translateX(0) rotateX(0); }

  .event-marker{
    position:absolute; left:-2px; top:28px; width:42px; height:42px; border-radius:50%;
    background:var(--accent); display:flex; align-items:center; justify-content:center;
    border:6px solid var(--bg); box-shadow:0 8px 24px rgba(15,23,36,0.06);
    transition: transform 420ms ease, box-shadow 240ms ease;
  }
  .event.visible .event-marker{ transform: scale(1.05); box-shadow: 0 12px 34px rgba(47,107,255,0.12); }
  .event-marker i{ font-size:18px; color:var(--primary); transition: transform 180ms ease; }
  .event-marker:hover i{ transform: rotate(-12deg) scale(1.05); }

  .event-time{ color:var(--primary); font-size:17px; font-weight:700; margin-bottom:6px; }
  .event-title{ font-size:21px; font-weight:700; margin:0 0 6px; }
  .event-speaker{ font-size:16px; color:var(--muted); margin:0 0 8px; }
  .event-desc{ font-size:17px; color:var(--muted); line-height:1.6; margin:0; }

  /* Register Card */
  .card{
    background:var(--card); padding:22px; border-radius:12px;
    border:1px solid rgba(15,23,36,0.08);
    box-shadow:0 8px 30px rgba(0,0,0,0.06);
    opacity:0; transform: translateY(10px) scale(0.995);
    transition: transform 480ms cubic-bezier(.2,.9,.3,1), opacity 420ms ease;
  }
  .card.visible{ opacity:1; transform: translateY(0) scale(1); }
  .card h3{ font-size:26px; font-weight:800; margin:0 0 14px; }
  .card-row{ display:flex; align-items:flex-start; gap:14px; margin:14px 0; }
  .card-row i{ font-size:20px; color:var(--primary); margin-top:2px; }
  .meta-title{ font-size:18px; font-weight:700; }
  .meta-sub{ font-size:15px; color:var(--muted); }

  @keyframes pulse { 0%{ box-shadow: 0 8px 22px rgba(47,107,255,0.12); transform: translateY(0) } 50%{ box-shadow: 0 18px 46px rgba(47,107,255,0.16); transform: translateY(-3px) } 100%{ box-shadow: 0 8px 22px rgba(47,107,255,0.12); transform: translateY(0) } }
  .register-btn{
    margin-top:18px; display:inline-flex; gap:10px; align-items:center;
    background:var(--primary); color:#fff; padding:14px 20px;
    font-size:17px; font-weight:700; text-decoration:none;
    border-radius:8px; border:0; cursor:pointer;
    position:relative; overflow:hidden;
  }
  .register-btn:hover{ animation: pulse 2.6s ease-in-out infinite; }
  .register-btn:active{ transform: translateY(-1px); }

  /* Speakers */
  .speakers-section{ grid-column: 1 / -1; margin-top:50px; opacity:0; transform: translateY(10px); transition: opacity 560ms ease, transform 560ms cubic-bezier(.2,.9,.3,1); }
  .speakers-section.visible{ opacity:1; transform: translateY(0); }

  .speakers-grid{ display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-top:18px; }

  .speaker-card{
    background: #fff; padding: 22px; border-radius: 12px; border: 1px solid rgba(15,23,36,0.08);
    box-shadow: 0 12px 30px rgba(0,0,0,0.06);
    transform: translateY(18px) rotateX(6deg) scale(0.995); opacity:0;
    transition: transform 560ms cubic-bezier(.2,.9,.3,1), opacity 520ms ease, box-shadow 220ms ease;
    will-change: transform, opacity; transform-origin: center top;
  }
  .speaker-card.visible{ transform: translateY(0) rotateX(0) scale(1); opacity:1; }
  .speaker-card:hover{ box-shadow: 0 20px 60px rgba(15,23,36,0.12); transform: translateY(-8px) rotateX(0) scale(1.02); }

  .speaker-top{ display:flex; align-items:center; gap:15px; margin-bottom:10px; }
  .speaker-top img{ width:70px; height:70px; border-radius:50%; object-fit:cover; transition: transform 360ms ease; }
  .speaker-card:hover .speaker-top img{ transform: scale(1.06) rotate(-1deg); }

  .speaker-top h3{ margin:0; font-size:20px; font-weight:700; }
  .speaker-top p{ margin:4px 0 0; color:var(--muted); font-size:14px; }
  .speaker-bio{ font-size:15px; color:var(--muted); line-height:1.6; margin-top:10px; }

  .icon-bounce:hover{ transform: translateY(-4px); transition: transform 220ms ease; }

  /* SECOND :root FOR MODAL THEME (OK, OVERRIDES SOME VARS) */
  :root{
    --bg:#f4f7fb;
    --card:#ffffff;
    --muted:#6b7280;
    --primary:#2f6bff;
    --radius:14px;
    --shadow: 0 18px 50px rgba(4,12,30,0.15);
  }

  /* backdrop */
  .modal-backdrop {
    position: fixed; inset: 0; display:flex; align-items:center; justify-content:center;
    background: rgba(6,10,22,0.45); z-index:1100;
    -webkit-tap-highlight-color: transparent;
  }

  /* modal card */
  .modal {
    width: 96%; max-width: 720px; background: var(--card); border-radius: var(--radius);
    padding: 22px; box-shadow: var(--shadow); position: relative;
    transform: translateY(18px) scale(0.98); opacity: 0;
    transition: transform 360ms cubic-bezier(.2,.9,.3,1), opacity 260ms ease;
    will-change: transform, opacity;
    overflow: visible;
  }
  .modal.show { transform: translateY(0) scale(1); opacity: 1; }

  .modal-close {
    position: absolute; right: 14px; top: 12px;
    background: transparent; border: none; font-size: 20px; cursor: pointer; color: #444;
  }

  .modal-title { margin:0 0 14px; font-size:20px; font-weight:800; color:#0f1724; }

  .row { display:flex; gap:14px; margin-bottom:12px; }
  .row label { flex:1; display:block; font-size:13px; color:#0f1724; font-weight:600; }
  .lbl { display:block; margin-bottom:6px; font-weight:700; font-size:13px; color:#0f1724; }

  input[type="text"], input[type="email"], input[type="tel"], select {
    width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(15,23,36,0.08);
    font-size:15px; outline:none; transition: box-shadow 160ms ease, border-color 160ms ease;
    background: #fff;
  }
  input:focus, select:focus { box-shadow: 0 6px 18px rgba(47,107,255,0.08); border-color: rgba(47,107,255,0.32); }

  .actions { display:flex; justify-content:flex-end; gap:10px; margin-top:6px; }
  .btn-ghost{ background:#f3f5f8; border:0; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:700; color:#111; }
  .btn-primary{ background:var(--primary); border:0; color:white; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:800; display:inline-flex; align-items:center; gap:10px; }

  .btn-spinner { width:14px; height:14px; border-radius:50%; border:2px solid rgba(255,255,255,0.3); border-top-color:white; display:none; animation: spin 900ms linear infinite; margin-left:6px; }
  @keyframes spin { to { transform: rotate(360deg);} }

  .success-panel { text-align:center; padding:18px 6px; }
  .checkmark { width:88px; height:88px; display:block; margin:8px auto 6px; }
  .check { stroke-dasharray: 60; stroke-dashoffset: 60; transition: stroke-dashoffset 520ms cubic-bezier(.2,.9,.3,1); }
  .success-panel.active .check { stroke-dashoffset: 0; }
  .success-text { font-weight:800; font-size:18px; margin-top:6px; color:#0f1724; }
  .success-sub { color:var(--muted); font-size:13px; margin-top:6px; }

  .confetti-canvas { position:absolute; left:0; top:0; width:100%; height:100%; pointer-events:none; }

  .field-error { border-color: #d14343 !important; box-shadow: 0 6px 18px rgba(209,67,67,0.06); }

  @media (max-width:980px){ .container{ grid-template-columns:1fr; } .card{ order:-1 } }
  @media (max-width:520px){ .hero h1{font-size:34px} .hero p{font-size:16px} .brand{font-size:18px} }

  @media (max-width:720px) {
    .row { flex-direction:column; }
    .modal { padding:16px; border-radius:12px; }
    .checkmark { width:72px; height:72px; }
  }

  @media (prefers-reduced-motion: reduce) {
    *, *::before, *::after { animation: none !important; transition: none !important; scroll-behavior: auto !important; }
    .hero-bg { transition: none; transform: none !important; }
    .hero.show h1, .hero.show p { animation: none; transform:none; opacity:1; }
    .header{ transform:none; opacity:1; }
    .event, .card, .speaker-card, .about, .schedule-title, .speakers-section { opacity:1; transform:none; }
    .register-btn:hover { animation: none; }
    .modal, .modal.show, .check, .btn-spinner { transition: none !important; animation: none !important; }
  }
</style>
</head>
<body>

<div class="scroll-progress" id="scrollProgress"></div>

<header class="header" id="siteHeader">
  <div class="brand">
    <i class="bi bi-ticket-perforated-fill icon-bounce"></i>
    <b>Event_Hub</b>
  </div>
</header>

<section class="hero" id="hero">
  <div class="hero-bg" id="heroBg" aria-hidden="true"></div>
  <div class="hero-inner">
    <h1 id="heroTitle">Digital Transformation Summit 2024</h1>
    <p id="heroSub">The future of web development is here. Join us for a deep dive into Next.js and Vercel.</p>
  </div>
</section>

<main class="container">
  <!-- LEFT -->
  <div>
    <section class="about" id="about">
      <h2>About the Event</h2>
      <p>A full day of talks from the creators of Next.js and the community. Learn about the latest features, best practices, and the future of the framework. Sessions cover everything from server components to advanced routing patterns.</p>
    </section>

    <div class="schedule-title" id="scheduleTitle">Schedule</div>

    <div class="timeline" id="timeline">
      <div class="event">
        <div class="event-marker"><i class="bi bi-clock"></i></div>
        <div class="event-time">09:00 AM</div>
        <div class="event-title">Keynote: The Future of the Web</div>
        <div class="event-speaker">By Jane Doe</div>
        <div class="event-desc">An opening talk about the direction of web development and Next.js.</div>
      </div>

      <div class="event">
        <div class="event-marker"><i class="bi bi-clock"></i></div>
        <div class="event-time">10:00 AM</div>
        <div class="event-title">Mastering Server Components</div>
        <div class="event-speaker">By John Smith</div>
        <div class="event-desc">A deep dive into React Server Components and their use in Next.js.</div>
      </div>

      <div class="event">
        <div class="event-marker"><i class="bi bi-clock"></i></div>
        <div class="event-time">11:00 AM</div>
        <div class="event-title">Coffee Break</div>
        <div class="event-desc">Networking and coffee.</div>
      </div>

      <div class="event">
        <div class="event-marker"><i class="bi bi-clock"></i></div>
        <div class="event-time">11:30 AM</div>
        <div class="event-title">Panel: The State of Jamstack</div>
        <div class="event-desc">A discussion with industry experts.</div>
      </div>

      <div class="event">
        <div class="event-marker"><i class="bi bi-clock"></i></div>
        <div class="event-time">12:30 PM</div>
        <div class="event-title">Lunch Break</div>
        <div class="event-desc">Enjoy a provided lunch.</div>
      </div>
    </div>
  </div>

  <!-- RIGHT -->
  <aside>
    <div class="card" id="registerCard">
      <h3>Register Now</h3>

      <div class="card-row">
        <i class="bi bi-calendar-event"></i>
        <div>
          <div class="meta-title">October 26, 2024</div>
          <div class="meta-sub">Event Date</div>
        </div>
      </div>

      <div class="card-row">
        <i class="bi bi-geo-alt"></i>
        <div>
          <div class="meta-title">Virtual</div>
          <div class="meta-sub">Venue</div>
        </div>
      </div>

      <button id="registerBtn" class="register-btn" style="margin-top:15px;">
        ðŸŽ« Register for this event
      </button>
    </div>
  </aside>

  <!-- Modal -->
  <div id="modalBackdrop" class="modal-backdrop" aria-hidden="true" style="display:none;">
    <div id="modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <button id="modalClose" class="modal-close" aria-label="Close">&times;</button>

      <h2 id="modalTitle" class="modal-title">Register for This Event</h2>

      <form id="regForm" action="../Backend/add_attendee.php" method="POST" novalidate>

    <!-- Hidden event ID (required for backend) -->
    <input type="hidden" name="event_id" value="1">

    <div class="row">
      <label>
        <span class="lbl">Name *</span>
        <input id="name" name="name" type="text" required />
      </label>

      <label>
        <span class="lbl">Email *</span>
        <input id="email" name="email" type="email" required />
      </label>
    </div>

    <div class="row">
      <label>
        <span class="lbl">Department *</span>
        <input id="department" name="department" type="text" required />
      </label>

      <label>
        <span class="lbl">University Roll No. *</span>
        <input id="roll" name="roll" type="text" required />
      </label>
    </div>

    <div class="row">
      <label>
        <span class="lbl">Phone *</span>
        <input id="phone" name="phone" type="tel" inputmode="tel" pattern="\d{6,15}" required />
      </label>

      <label>
        <span class="lbl">Food Preference</span>
        <select id="food" name="food">
          <option>No preference</option>
          <option>Vegetarian</option>
          <option>Vegan</option>
          <option>Halal</option>
          <option>Other</option>
        </select>
      </label>
    </div>

    <div class="actions">
      <button type="button" id="cancelBtn" class="btn-ghost">Cancel</button>
      <button type="submit" id="submitBtn" class="btn-primary">
        <span class="btn-text">Submit</span>
        <span class="btn-spinner" aria-hidden="true"></span>
      </button>
    </div>

</form>

      <div id="successPanel" class="success-panel" aria-hidden="true" style="display:none;">
        <svg class="checkmark" viewBox="0 0 52 52" aria-hidden="true">
          <circle cx="26" cy="26" r="25" fill="none" stroke="#2f6bff" stroke-width="2" />
          <path class="check" fill="none" stroke="#2f6bff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" d="M14 27l7 7 17-17"/>
        </svg>
        <div class="success-text">Registration complete</div>
        <div class="success-sub">Thanks â€” we have recorded your registration.</div>
      </div>

      <canvas id="confettiCanvas" class="confetti-canvas" aria-hidden="true"></canvas>
    </div>
  </div>

  <!-- Speakers -->
  <section class="speakers-section" id="speakersSection">
    <h2 style="font-size:32px; font-weight:800; margin:0 0 10px;">Speakers</h2>
    <div class="speakers-grid">
      <div class="speaker-card">
        <div class="speaker-top">
          <img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=160&q=80" alt="Jane Doe">
          <div>
            <h3>Jane Doe</h3>
            <p>Lead Engineer, Vercel</p>
          </div>
        </div>
        <p class="speaker-bio">Jane is a lead engineer at Vercel, focusing on the Next.js framework. She is passionate about open-source and building performant web experiences.</p>
      </div>

      <div class="speaker-card">
        <div class="speaker-top">
          <img src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=160&q=80" alt="John Smith">
          <div>
            <h3>John Smith</h3>
            <p>Developer Advocate, Google</p>
          </div>
        </div>
        <p class="speaker-bio">John is a developer advocate at Google, specializing in web performance and Core Web Vitals. He loves helping developers build faster websites.</p>
      </div>
    </div>
  </section>

</main>

<script>
(() => {
  const reduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

  /* HEADER + HERO ON LOAD */
  window.addEventListener('load', () => {
    const header = document.getElementById('siteHeader');
    const hero = document.getElementById('hero');
    if (header) header.classList.add('visible');
    if (hero) hero.classList.add('show');

    document.querySelectorAll('.about, .schedule-title, .card, .event, .speakers-section, .speaker-card')
      .forEach(el => el.classList.add('visible'));
  });

  /* SCROLL PROGRESS BAR */
  const progress = document.getElementById('scrollProgress');
  function updateProgress() {
    if (!progress) return;
    const h = document.documentElement;
    const scrollTop = h.scrollTop || document.body.scrollTop;
    const docHeight = h.scrollHeight - h.clientHeight;
    const pct = docHeight ? (scrollTop / docHeight) : 0;
    progress.style.transform = `scaleX(${pct})`;
  }
  window.addEventListener('scroll', updateProgress, { passive: true });
  updateProgress();

  /* HERO PARALLAX */
  const hero = document.getElementById('hero');
  const heroBg = document.getElementById('heroBg');
  if (hero && heroBg && !reduced) {
    hero.addEventListener('mousemove', (e) => {
      const r = hero.getBoundingClientRect();
      const px = (e.clientX - r.left) / r.width - 0.5;
      const py = (e.clientY - r.top) / r.height - 0.5;
      const tx = px * 14, ty = py * 10;
      heroBg.style.transform = `translate3d(${tx}px, ${ty}px, 0) scale(1.02)`;
    });
    hero.addEventListener('mouseleave', () => {
      heroBg.style.transform = 'translate3d(0,0,0) scale(1)';
    });
  }

  /* REGISTER BUTTON RIPPLE */
  const registerBtn = document.getElementById('registerBtn');
  if (registerBtn) {
    registerBtn.addEventListener('click', (e) => {
      const rect = registerBtn.getBoundingClientRect();
      const ripple = document.createElement('span');
      const size = Math.max(rect.width, rect.height) * 1.6;
      ripple.style.position = 'absolute';
      ripple.style.left = `${e.clientX - rect.left - size/2}px`;
      ripple.style.top = `${e.clientY - rect.top - size/2}px`;
      ripple.style.width = ripple.style.height = `${size}px`;
      ripple.style.borderRadius = '50%';
      ripple.style.background = 'rgba(255,255,255,0.12)';
      ripple.style.pointerEvents = 'none';
      ripple.style.transform = 'scale(0)';
      ripple.style.opacity = '0.9';
      ripple.style.transition = 'transform 560ms cubic-bezier(.2,.9,.3,1), opacity 560ms ease';
      registerBtn.appendChild(ripple);
      requestAnimationFrame(() => {
        ripple.style.transform = 'scale(1)';
        ripple.style.opacity = '0';
      });
      setTimeout(() => ripple.remove(), 700);
    }, { passive: false });
  }

  /* MODAL + FORM + CONFETTI */
  const backdrop = document.getElementById('modalBackdrop');
  const modal = document.getElementById('modal');
  const closeBtn = document.getElementById('modalClose');
  const cancelBtn = document.getElementById('cancelBtn');
  const form = document.getElementById('regForm');
  const successPanel = document.getElementById('successPanel');
  const confettiCanvas = document.getElementById('confettiCanvas');
  let confettiCtx = null, confettiParticles = [], confettiAnimId = null;

  function openModal() {
    if (!backdrop || !modal) return;
    backdrop.style.display = 'flex';
    backdrop.setAttribute('aria-hidden', 'false');
    requestAnimationFrame(() => modal.classList.add('show'));
    resizeCanvas();
    const first = modal.querySelector('input,select,button,textarea');
    if (first) first.focus();
    document.addEventListener('keydown', onKeyDown);
  }

  function closeModal() {
    if (!backdrop || !modal) return;
    modal.classList.remove('show');
    backdrop.style.display = 'none';
    backdrop.setAttribute('aria-hidden', 'true');
    document.removeEventListener('keydown', onKeyDown);

    if (form) {
      form.reset();
      form.style.display = '';
      form.style.opacity = '';
      form.style.transform = '';
    }
    if (successPanel) {
      successPanel.style.display = 'none';
      successPanel.classList.remove('active');
    }
    stopConfetti();
  }

  function onKeyDown(e) {
    if (e.key === 'Escape') closeModal();
  }

  if (registerBtn) {
    registerBtn.addEventListener('click', (e) => {
      e.preventDefault();
      openModal();
    });
  }
  if (closeBtn) closeBtn.addEventListener('click', closeModal);
  if (cancelBtn) cancelBtn.addEventListener('click', closeModal);
  if (backdrop) {
    backdrop.addEventListener('click', (e) => {
      if (e.target === backdrop) closeModal();
    });
  }

  function getValues() {
    if (!modal) return {};
    return {
      name: modal.querySelector('#name')?.value.trim() || '',
      email: modal.querySelector('#email')?.value.trim() || '',
      department: modal.querySelector('#department')?.value.trim() || '',
      roll: modal.querySelector('#roll')?.value.trim() || '',
      phone: modal.querySelector('#phone')?.value.trim() || '',
      food: modal.querySelector('#food')?.value || ''
    };
  }

  function validate(values) {
    const errs = {};
    if (!values.name) errs.name = 'Name required';
    if (!values.email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(values.email)) errs.email = 'Valid email required';
    if (!values.department) errs.department = 'Department required';
    if (!values.roll) errs.roll = 'Roll required';
    if (!values.phone || !/^\d{6,15}$/.test(values.phone)) errs.phone = 'Phone 6â€“15 digits';
    return errs;
  }

  function showErrors(errs) {
    if (!modal) return;
    modal.querySelectorAll('input,select').forEach(el => el.classList.remove('field-error'));
    Object.keys(errs).forEach(k => {
      const el = modal.querySelector('#' + k);
      if (el) el.classList.add('field-error');
    });
  }

  /* FORM SUBMIT (real submission) */
  if (form) {
    form.addEventListener('submit', (e) => {

        const values = getValues();
        const errs = validate(values);

        if (Object.keys(errs).length) {
            e.preventDefault();
            showErrors(errs);
            return;
        }
    });
}

  function resizeCanvas() {
    if (!confettiCanvas || !modal) return;
    confettiCanvas.width = modal.clientWidth;
    confettiCanvas.height = modal.clientHeight;
    confettiCtx = confettiCanvas.getContext('2d');
  }

  function startConfetti() {
    if (!confettiCanvas || !confettiCtx) return;
    confettiParticles = [];
    const count = 70;
    for (let i = 0; i < count; i++) {
      confettiParticles.push({
        x: confettiCanvas.width / 2 + (Math.random() - 0.5) * 120,
        y: confettiCanvas.height / 4 + (Math.random() - 0.5) * 60,
        vx: (Math.random() - 0.5) * 6,
        vy: Math.random() * 6 + 2,
        size: Math.random() * 8 + 6,
        rot: Math.random() * 360,
        vr: (Math.random() - 0.5) * 6,
        color: `hsl(${Math.floor(Math.random()*60 + 200)},70%,55%)`
      });
    }
    renderConfetti();
  }

  function renderConfetti() {
    if (!confettiCtx || !confettiCanvas) return;
    confettiCtx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
    confettiParticles.forEach(p => {
      p.x += p.vx;
      p.y += p.vy;
      p.vy += 0.18;
      p.rot += p.vr;
      confettiCtx.save();
      confettiCtx.translate(p.x, p.y);
      confettiCtx.rotate(p.rot * Math.PI / 180);
      confettiCtx.fillStyle = p.color;
      confettiCtx.fillRect(-p.size/2, -p.size/2, p.size, p.size*0.6);
      confettiCtx.restore();
    });
    confettiParticles = confettiParticles.filter(p => p.y < confettiCanvas.height + 60);
    confettiAnimId = requestAnimationFrame(renderConfetti);
  }

  function stopConfetti() {
    if (confettiAnimId) cancelAnimationFrame(confettiAnimId);
    if (confettiCtx && confettiCanvas) {
      confettiCtx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
    }
  }

})();

/* âœ… SUCCESS POPUP INSERTED HERE */
if (window.location.search.includes("success=1")) {
    alert("Registration successful!");
}
</script>


</body>
</html>
